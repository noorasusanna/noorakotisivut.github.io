<!doctype html>
<html lang="en">
    <head>
        <script src="https://kit.fontawesome.com/c9fe447731.js"
            crossorigin="anonymous"></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Visit Westeros</title>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
            crossorigin="anonymous">
        <link rel="stylesheet" href="css/styling.css">
    </head>
    <body>
        <!-- Modal -->
        <div class="modal fade" id="exampleModal" tabindex="-1"
            role="dialog" aria-labelledby="exampleModalLabel"
            aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header border-0">
                        <h5 class="modal-title fs-5" id="exampleModalLabel">Random
                            Cat Generator @TheCatAPI
                        </h5>
                        <button type="button" class="btn-close"
                            data-bs-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div id="vote-options" class="vote-options">
                            <button onClick="vote(1)">meow ̳ ៱˳_˳៱ ̳ ∫</button>
                            <div>
                                <img id="image-to-vote-on" class="col-lg"
                                    alt="cat generator">
                            </div>
                        </div>
                    </div>
                    <div id="vote-results" class="vote-results">
                        <button onClick="showVoteOptions()">Show Vote Options</button>
                        <div id="grid" class="imgrid"></div>
                    </div>
                </div>
            </div>
        </div>
        <!--Navbar-->
        <nav class="navbar navbar-expand-lg fixed-top navbar-light">
            <div id="topnav" class="container">
                <i id="logo" class="fa-solid fa-dragon fa-lg"></i>
                <a id="title" class="navbar-brand" href="index.html">Visit
                    Westeros</a>
                <button
                    class="navbar-toggler"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#topnav-centered">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div id="topnav-centered" class="collapse navbar-collapse">
                    <ul class="navbar-nav mx-auto">
                        <li class="nav-item">
                            <a href="places.html" class="nav-link link-dark">Places
                                to go</a>
                        </li>
                        <li class="nav-item">
                            <a id="spacing" href="things.html" class="nav-link
                                link-dark">Things
                                to do</a>
                        </li>
                        <li class="nav-item">
                            <a href="tips.html" class="nav-link link-dark">Tips
                                for your trip</a>
                        </li>
                    </ul>
                </div>
                <div id="icon1">
                    <a href="#" class="link-dark"><i class="fa-solid
                            fa-magnifying-glass"></i></a>
                </div>
                <div id="icon2">
                    <a href="#" class="link-dark"><i class="fa-regular
                            fa-heart"></i></a>
                </div>
                <div id="icon3">
                    <a href="#" class="link-dark"><i class="fa-solid fa-bars"></i></a>
                </div>
            </div>
        </nav>
        <!--Carousel-->
        <div id="carouselExampleIndicators" class="carousel slide"
            data-bs-ride="true">
            <div class="carousel-indicators">
                <button type="button"
                    data-bs-target="#carouselExampleIndicators"
                    data-bs-slide-to="0" class="active" aria-current="true"
                    aria-label="Slide 1"></button>
                <button type="button"
                    data-bs-target="#carouselExampleIndicators"
                    data-bs-slide-to="1" aria-label="Slide 2"></button>
                <button type="button"
                    data-bs-target="#carouselExampleIndicators"
                    data-bs-slide-to="2" aria-label="Slide 3"></button>
            </div>
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img src="photos/kl22.png" class="d-block w-100"
                        alt="King's
                        Landing">
                </div>
                <div class="carousel-item">
                    <img src="photos/winterfell.jpg" class="d-block w-100"
                        alt="Winterfell">
                </div>
                <div class="carousel-item">
                    <img src="photos/ds.jpg" class="d-block w-100"
                        alt="Dragonstone">
                </div>
            </div>
            <button class="carousel-control-prev" type="button"
                data-bs-target="#carouselExampleIndicators"
                data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button"
                data-bs-target="#carouselExampleIndicators"
                data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>

        <!-- Footer -->
        <footer class=" text-center " style="background-color:#fdf9f2;">
            <div class="container p-4">
                <!-- Section: Social media -->
                <div class="mb-4">
                    <!-- Facebook -->
                    <a href="#" class="link-dark"><i class="fa-brands
                            fa-facebook fa-lg"></i></a>

                    <!-- Twitter -->
                    <a href="#" class="link-dark"><i class="fa-brands fa-twitter
                            fa-lg"></i></a>

                    <!-- Google -->
                    <a href="#" class="link-dark"><i class="fa-brands fa-google
                            fa-lg"></i></a>

                    <!-- Instagram -->
                    <a href="#" class="link-dark"><i class="fa-brands
                            fa-instagram fa-lg"></i></a>
                </div>

                <!-- Section: Form -->
                <section>
                    <div class="row d-flex justify-content-center">
                        <div class="col-auto">
                            <p class="pt-2">
                                <strong>Sign up for our newsletter</strong>
                            </p>
                        </div>

                        <div class="col-md-5 col-12">
                            <!-- Email input -->
                            <div class="form-outline mb-4">
                                <input type="email" id="form5Example2"
                                    class="form-control">
                                <label class="form-label"
                                    for="form5Example2">Email address</label>
                            </div>
                        </div>

                        <div class="col-auto">

                            <!-- Submit button -->
                            <!-- Button trigger modal -->
                            <button type="button" class="btn
                                btn-outline-secondary"
                                data-bs-toggle="modal"
                                data-bs-target="#exampleModal">
                                Subscribe
                            </button>

                        </div>
                    </div>
                </section>

                <!-- Footer: Links -->
                <section class="">
                    <div class="row">
                        <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                            <a href="#" class="nav-link">Terms of use</a>
                        </div>

                        <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                            <a href="#" class="nav-link">Accessibility</a>
                        </div>

                        <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                            <a href="#" class="nav-link">Blog</a>
                        </div>

                        <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                            <a href="#" class="nav-link">Media</a>
                        </div>
                    </div>
                </section>

            </div>

            <!-- Copyright -->
            <div class="text-center p-3" style="background-color: rgba(0, 0,
                0,
                0.2)">
                © VisitWesteros.com 2022
            </div>
        </footer>

        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
            crossorigin="anonymous"></script>
        <script
            src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
            integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
            crossorigin="anonymous"></script>
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.min.js"
            integrity="sha384-IDwe1+LCz02ROU9k972gdyvl+AESN10+x7tBKgc9I5HFtuNz0wWnPclzo6p9vxnk"
            crossorigin="anonymous"></script>
        <script>
            const API_URL  = `https://api.thecatapi.com/v1/`;
            const API_KEY = "live_FXaBfEhgFPcjCb3ntmlGIeBGECfTmDhOlkpn1K9Sk70Xq12pbfxTO7ZuYwecSP84"
            let currentImageToVoteOn;

            function showHistoricVotes()
            {
            

            const url = `${API_URL}votes?limit=10&order=DESC`;

            fetch(url,{headers: {
                'x-api-key': API_KEY
            }})
            .then((response) => {
                return response.json();
            })
            .then((data) => {
            
                data.map(function(voteData) {
            
                const imageData = voteData.image
            
                let image = document.createElement('img');
                //use the url from the image object
                image.src = imageData.url
                        
                let gridCell = document.createElement('div');
                
                if(voteData.value<0)
                {
                    gridCell.classList.add('red') 
                } else {
                    gridCell.classList.add('green')
                }
                
                gridCell.classList.add('col-lg');

                gridCell.appendChild(image)
                
                document.getElementById('grid').appendChild(gridCell);
                
                });
            
            })
            .catch(function(error) {
                console.log(error);
            });
            
            }

            function showVoteOptions()
            {
            document.getElementById("grid").innerHTML = '';
            
            document.getElementById('vote-results').style.display = 'none';
            
            showImageToVoteOn()
            }

            function showImageToVoteOn()
            {
            
            const url = `${API_URL}images/search`;

            fetch(url,{headers: {
                'x-api-key': API_KEY
            }})
            .then((response) => {
                return response.json();
            })
            .then((data) => {
                currentImageToVoteOn = data[0];
                document.getElementById("image-to-vote-on").src= currentImageToVoteOn.url;
            });

            }

            function vote(value)
            {
            
            const url = `${API_URL}votes/`;
            const body = {
                image_id:currentImageToVoteOn.id,
                value
            }
            fetch(url,{method:"POST",body:JSON.stringify(body),headers: {
                'content-type':"application/json",
                'x-api-key': API_KEY
            }})
            .then((response) => {
                showVoteOptions()
            })
            }

            showVoteOptions()

        </script>
        <script>
            var prevScrollpos = window.pageYOffset;
            window.onscroll = function() {
            var currentScrollPos = window.pageYOffset;
            if (prevScrollpos > currentScrollPos) {
            document.getElementById("navbar").style.top = "0";
            } else {
            document.getElementById("navbar").style.top = "-50px";
            }
            prevScrollpos = currentScrollPos;
            }
        </script>
    </body>
</html>
